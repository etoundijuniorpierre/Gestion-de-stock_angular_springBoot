<div class="col mouvements-stocks">
  <div class="row m-3">
    <div class="col-md-8 p-0">
      <h1>Mouvements du stock</h1>
    </div>
    <div class="col-md-4 p-0 text-right">
      <app-button-action
      [isImporterVisible]="false"
      [isNouveauVisible]="false"
      ></app-button-action>
    </div>
  </div>
  <!-- Sélection d'article -->
  <div class="row m-3">
    <div class="col-md-6">
      <label for="articleSelect" class="form-label">Sélectionner un article</label>
      <select class="form-control" id="articleSelect" (change)="onArticleSelect($any($event.target).selectedOptions[0]._value)">
        <option value="">-- Choisir un article --</option>
        <option *ngFor="let article of articles" [value]="article">
          {{ article.codeArticle }} - {{ article.designation }}
        </option>
      </select>
    </div>
    <div class="col-md-6" *ngIf="selectedArticle">
      <div class="card">
        <div class="card-body">
          <h6 class="card-title">Stock actuel</h6>
          <p class="card-text">
            <strong>Article:</strong> {{ selectedArticle.designation }}<br>
            <strong>Stock réel:</strong> <span class="badge bg-primary">{{ stockReel }}</span>
          </p>
        </div>
      </div>
    </div>
  </div>
  <div class="col">
    <div class="accordion" id="mvtStkDetails">
      <div class="card">
        <div class="card-body" id="headingOne">
          <button class="btn btn-block text-left" type="button" 
                  (click)="toggleCollapseOne()" 
                  [attr.aria-expanded]="getAriaExpandedOne()" 
                  aria-controls="collapseOne">
            <app-detail-mvt-stk-article 
              *ngIf="selectedArticle"
              [article]="selectedArticle" 
              [stockActuel]="stockReel">
            </app-detail-mvt-stk-article>
          </button>
        </div>
        <div [id]="'collapseOne'" 
             [class]="getCollapseOneClass()" 
             aria-labelledby="headingOne" 
             data-parent="#mvtStkDetails" 
             style="max-height: 300px; overflow-y: scroll;">
          <div class="card-body">
            <div *ngIf="isLoading" class="text-center">
              <div class="spinner-border" role="status">
                <span class="sr-only">Chargement...</span>
              </div>
            </div>
            <div *ngIf="!isLoading && mouvementsStock.length === 0" class="text-center">
              <p>Aucun mouvement de stock trouvé pour cet article.</p>
            </div>
            <app-detail-mvt-stk 
              *ngFor="let mouvement of mouvementsStock" 
              [mouvement]="mouvement">
            </app-detail-mvt-stk>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row mb-3">
    <div class=" col-md-12 text-center">
      <app-pagination></app-pagination>
    </div>
  </div>
</div>